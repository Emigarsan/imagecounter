<!-- admin.html actualizado con control de imagen del villano -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Panel de Administración</title>
    <style>
        /* Estilos omitidos por brevedad, idénticos al original */
    </style>
</head>
<body>
<div class="overlay">
    <h2>Panel de Administración</h2>

    <div th:if="${notLoggedIn}">
        <form method="post" action="/admin/login">
            <input type="password" id="password" name="password" placeholder="Contraseña" required>
            <br>
            <button type="submit">Ingresar</button>
        </form>
        <p th:if="${loginFailed}" style="color: red;">Contraseña incorrecta.</p>
    </div>

    <div th:if="${loggedIn}">
        <div>
            <input type="number" id="value1" placeholder="Valor Villano" th:value="${value1}" required><br>
            <input type="number" id="value2" placeholder="Valor Entrenamiento" th:value="${value2}" required><br>
            <button onclick="updateValues()">Actualizar</button>
        </div>

        <div style="margin-top: 30px;">
            <h3>Cambiar imagen del villano</h3>
            <button onclick="setVillainImage('normal')">Imagen Normal</button>
            <button onclick="setVillainImage('alt')">Imagen Alternativa</button>
        </div>
    </div>
</div>

<div id="successPopup" class="popup">Los valores fueron actualizados</div>

<script>
    function updateValues() {
        const v1 = document.getElementById('value1').value;
        const v2 = document.getElementById('value2').value;

        fetch('/admin/update', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `value1=${v1}&value2=${v2}`
        })
        .then(res => res.text())
        .then(response => {
            if (response === 'success') {
                const popup = document.getElementById('successPopup');
                popup.style.display = 'block';
                setTimeout(() => {
                    popup.style.display = 'none';
                    location.reload();
                }, 2000);
            } else {
                alert('Error al actualizar los valores');
            }
        });
    }

    function setVillainImage(mode) {
        fetch('/admin/set-image', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `imageMode=${mode}`
        })
        .then(res => res.text())
        .then(response => {
            if (response === 'success') {
                alert('Imagen del villano actualizada a: ' + mode);
            } else {
                alert('Error al cambiar la imagen');
            }
        });
    }
</script>
</body>
</html>
